<!DOCTYPE html><html><head><meta charset="utf-8"><style>body {
  width: 45em;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 30px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAzUABAAAAAAFNgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABbAAAABwAAAAcZMzaOEdERUYAAAGIAAAAHQAAACAAOQAET1MvMgAAAagAAAA+AAAAYHqhde9jbWFwAAAB6AAAAFIAAAFa4azkLWN2dCAAAAI8AAAAKAAAACgFgwioZnBnbQAAAmQAAAGxAAACZVO0L6dnYXNwAAAEGAAAAAgAAAAIAAAAEGdseWYAAAQgAAAFDgAACMz7eroHaGVhZAAACTAAAAAwAAAANgWEOEloaGVhAAAJYAAAAB0AAAAkDGEGa2htdHgAAAmAAAAAEwAAADBEgAAQbG9jYQAACZQAAAAaAAAAGgsICJBtYXhwAAAJsAAAACAAAAAgASgBD25hbWUAAAnQAAACZwAABOD4no+3cG9zdAAADDgAAABsAAAAmF+yXM9wcmVwAAAMpAAAAC4AAAAusPIrFAAAAAEAAAAAyYlvMQAAAADLVHQgAAAAAM/u9uZ4nGNgZGBg4ANiCQYQYGJgBEJuIGYB8xgABMMAPgAAAHicY2Bm42OcwMDKwMLSw2LMwMDQBqGZihmiwHycoKCyqJjB4YPDh4NsDP+BfNb3DIuAFCOSEgUGRgAKDgt4AAB4nGNgYGBmgGAZBkYGEAgB8hjBfBYGCyDNxcDBwMTA9MHhQ9SHrA8H//9nYACyQyFs/sP86/kX8HtB9UIBIxsDXICRCUgwMaACRoZhDwA3fxKSAAAAAAHyAHABJQB/AIEAdAFGAOsBIwC/ALgAxACGAGYAugBNACcA/wCIeJxdUbtOW0EQ3Q0PA4HE2CA52hSzmZDGe6EFCcTVjWJkO4XlCGk3cpGLcQEfQIFEDdqvGaChpEibBiEXSHxCPiESM2uIojQ7O7NzzpkzS8qRqnfpa89T5ySQwt0GzTb9Tki1swD3pOvrjYy0gwdabGb0ynX7/gsGm9GUO2oA5T1vKQ8ZTTuBWrSn/tH8Cob7/B/zOxi0NNP01DoJ6SEE5ptxS4PvGc26yw/6gtXhYjAwpJim4i4/plL+tzTnasuwtZHRvIMzEfnJNEBTa20Emv7UIdXzcRRLkMumsTaYmLL+JBPBhcl0VVO1zPjawV2ys+hggyrNgQfYw1Z5DB4ODyYU0rckyiwNEfZiq8QIEZMcCjnl3Mn+pED5SBLGvElKO+OGtQbGkdfAoDZPs/88m01tbx3C+FkcwXe/GUs6+MiG2hgRYjtiKYAJREJGVfmGGs+9LAbkUvvPQJSA5fGPf50ItO7YRDyXtXUOMVYIen7b3PLLirtWuc6LQndvqmqo0inN+17OvscDnh4Lw0FjwZvP+/5Kgfo8LK40aA4EQ3o3ev+iteqIq7wXPrIn07+xWgAAAAABAAH//wAPeJyFlctvG1UUh+/12DPN1B7P3JnYjj2Ox4/MuDHxJH5N3UdaEUQLqBIkfQQioJWQ6AMEQkIqsPGCPwA1otuWSmTBhjtps2ADWbJg3EpIXbGouqSbCraJw7kzNo2dRN1cnXN1ZvT7zuuiMEI7ncizyA0URofRBJpCdbQuIFShYY+GZRrxMDVtih5TwQPHtXDFFSIKoWIbuREBjLH27Ny4MsbVx+uOJThavebgVrNRLAiYx06rXsvhxLgWx9xpfHdrs/ekc2Pl2cpPCVEITQpwbj8VQhfXSq2m+Wxqaq2D73Kne5e3NjHqQNj3CRYlJlgUl/jRNP+2Gs2pNYRQiOnmUaQDqm30KqKiTTWPWjboxnTWpvgxjXo0KrtZXAHt7hwIz0YVcj88JnKlJKi3NPAwLyDwZudSmJSMMJFDYaOkaol6XtESx3Gt1VTytdZJ3DCLeaVhVnCBH1fycHTxFXwPX+l2e3d6H/TufGGmMTLTnbSJUdo00zuBswMO/nl3YLeL/wnu9/limCuD3vC54h5NBVz6Li414AI8Vx3iiosKcQXUbrvhFFiYb++HN4DaF4XzFW0fIN4XDWJ3a3XQoq9V8WiyRmdsatV9xUcHims1JloH0YUa090G3Tro3mC6c01f+YwCPquINr1PTaCP6rVTOOmf0GE2dBc7zWIhji3/5MchSuBHgDbU99RMWt3YUNMZMJmx92YP6NsHx/5/M1yvInpnkIOM3Z8fA3JQ2lW1RFC1KaBPDFXNAHYYvGy73aYZZZ3HifbeuiVZCpwA3oQBs0wGPYJbJfg60xrKEbKiNtTe1adwrpBRwlAuQ3q3VRaX0QmQ9a49BTSCuF1MLfQ6+tinOubRBZuWPNoMevGMT+V41KitO1is3D/tpMcq1JHZqDHGs8DoYGDkxJgKjHROeTCmhZvzPm9pod+ltKm4PN7Dyvvldlpsg8D+4AUJZ3F/JBstZz7cbFRxsaAGV6yX/dkcycWf8eS3QlQea+YLjdm3yrOnrhFpUyKVvFE4lpv4bO3Svx/6F/4xmiDu/RT5iI++lko18mY1oX+5UGKR6kmVjM/Zb76yfHtxy+h/SyQ0lLdpdKy/lWB6szatetQJ8nZ80A2Qt6ift6gJeavU3BO4gtxs/KCtNPVibCtYCWY3SIlSBPKXZALXiIR9oZeJ1AuMyxLpHIy/yO7vSiSE+kZvk0ihJ30HgHfzZtEMmvV58x6dtqns0XTAW7Vdm4HJ04OCp/crOO7rd9SGxQAE/mVA9xRN+kVSMRFF6S9JFGUtthkjBA5tFCWc2l4V43Ex9GmUP3SI37Jjmir9KqlaDJ4S4JB3vuM/jzyH1+8MuoZ+QGzfnvPoJb96cZlWjMcKLfgDwB7E634JTY+asjsPzS5CiVnEWY+KsrsIN5rn3mAPjqmQBxGjcGKB9f9ZxY3mYC2L85CJ2FXIxKKyHk+dg0FHbuEc7D5NzWUX32WxFcWNGRAbvwSx0RmIXVDuYySafluQBmzA/ssqJAMLnli+WIC90Gw4lm85wcp0qjArEDPJJV/sSx4P9ungTpgMw5gVC1XO4uULq0s3v1rqLi0vX/z65vlH50f8T/RHmSPTk5xxWBWOluMT6WiOy+tdvWxlV/XQb3o3c6Ssr+r6I708GsX9/nzp1tKFh0s3v7m4vAy/Hnb/KMOvc1wump6Il48K6mGDy02X9Yd65pa+nQIjk76lWxCkG8NBCP0HQS9IpAAAeJxjYGRgYGBhcCrq214Qz2/zlUGenQEEzr/77oug/zewFbB+AHI5GJhAogBwKQ0qeJxjYGRgYH3/P46BgZ0BBNgKGBgZUAEPAE/7At0AAAB4nGNngAB2IGYjhBsYBAAIYADVAAAAAAAAAAAAAFwAyAEeAaACCgKmAx4DggRmAAAAAQAAAAwAagAEAAAAAAACAAEAAgAWAAABAAChAAAAAHiclZI7bxQxFIWPd/JkUYQChEhIyAVKgdBMskm1QkKrRETpQiLRUczueB/K7HhlOxttg8LvoKPgP9DxFxANDR0tHRWi4NjrPIBEgh1p/dm+vufcawNYFWsQmP6e4jSyQB2fI9cwj++RE9wTjyPP4LYoI89iWbyLPIe6+Bh5Hs9rryMv4GbtW+RF3EhuRa7jbrIbeQkPkjdUETOLnL0Kip4FVvAhco1RXyMnSPEz8gzWxE7kWTwUp5HnsCLeR57HW/El8gJWa58iL+JO7UfkOh4l9yMv4UnyEtvQGGECgwF66MNBooF1bGCL1ELB/TYU+ZBRlvsKQ44Se6jQ4a7hef+fh72Crv25kp+8lNWGmeKoOI5jJLb1aGIGvb6TjfWNLdkqdFvJw4l1amjlXtXRZqRN7lSRylZZyhBqpVFWmTEXgWfUrpi/hZOQXdOd4rKuXOtEWT3k5IArPRzTUU5tHKjecZkTpnVbNOnt6jzN8240GD4xtikvZW56043rPMg/dS+dlOceXoR+WPbJ55Dsekq1lJpnypsMUsYOdCW30o103Ytu/lvh+5RWFLfBjm9/N8hJntPhvx92rnoE/kyHdGasGy754kw36vsVf/lFeBi+0COu+cfgQr42G3CRpeLoZ53gmfe3X6rcKt5oVxnptHR9JS8ehVUd5wvvahN2uqxOOpMXapibI5k7Zwbt4xBSaTfoKBufhAnO/uqNcfK8OTs0OQ6l7JIqFjDhYj5WcjevCnI/1DDiI8j4ndWb/5YzDZWh79yomWXeXj7Nnw70/2TIeFPTrlSh89k1ObOSRVZWZfgF0r/zJQB4nG2JUQuCQBCEd07TTg36fb2IyBaLd3vWaUh/vmSJnvpgmG8YcmS8X3Shf3R7QA4OBUocUKHGER5NNbOOEvwc1txnuWkTRb/aPjimJ5vXabI+3VfOiyS15UWvyezM2xiGOPyuMohOH8O8JiO4Af+FsAGNAEuwCFBYsQEBjlmxRgYrWCGwEFlLsBRSWCGwgFkdsAYrXFhZsBQrAAA=) format('woff');
}

@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headeranchor-link {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .headeranchor-link:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .headeranchor,
.markdown-body h2 .headeranchor,
.markdown-body h3 .headeranchor,
.markdown-body h4 .headeranchor,
.markdown-body h5 .headeranchor,
.markdown-body h6 .headeranchor {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .headeranchor-link,
.markdown-body h2:hover .headeranchor-link,
.markdown-body h3:hover .headeranchor-link,
.markdown-body h4:hover .headeranchor-link,
.markdown-body h5:hover .headeranchor-link,
.markdown-body h6:hover .headeranchor-link {
  height: 1em;
  padding-left: 8px;
  margin-left: -30px;
  line-height: 1;
  text-decoration: none;
}

.markdown-body h1:hover .headeranchor-link .headeranchor,
.markdown-body h2:hover .headeranchor-link .headeranchor,
.markdown-body h3:hover .headeranchor-link .headeranchor,
.markdown-body h4:hover .headeranchor-link .headeranchor,
.markdown-body h5:hover .headeranchor-link .headeranchor,
.markdown-body h6:hover .headeranchor-link .headeranchor {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* Multimarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px octicons-anchor;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\f05c';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><title>02-setup</title></head><body><article class="markdown-body"><h2 id="setting-up-the-elk-stack"><a name="user-content-setting-up-the-elk-stack" href="#setting-up-the-elk-stack" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Setting up the ELK Stack</h2>
<p><img alt="ELK Basic Setup" src="./images/ELK_basic_setup.png" /></p>
<p><small>[90 minutes]</small></p>
<hr />
<h3 id="overall-architecture-diagram"><a name="user-content-overall-architecture-diagram" href="#overall-architecture-diagram" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Overall architecture diagram</h3>
<p><img alt="" src="./images/ourstructure.png" /></p>
<hr />
<h3 id="the-virtual-machine"><a name="user-content-the-virtual-machine" href="#the-virtual-machine" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>The Virtual Machine</h3>
<hr />
<p>Import the provided <code>infra-mon-elk.ova</code> file into Virtual Box<br />
<img alt="" src="./images/setup/vbox_import_ova.png" /></p>
<hr />
<p>Change the location of the disk (if you want)<br />
<img alt="" src="./images/setup/vbox_import_ova_change_disk_location.png" /></p>
<hr />
<p>Boot the VM<br />
<pre><code>user: ninja
password: ninja
</code></pre></p>
<hr />
<p>Check your IP address</p>
<pre><code>ifconfig
</code></pre>

<hr />
<p>Check connectivity to the VM <strong>from</strong> your local computer</p>
<pre><code>ping &lt;IP_obtained_from_previous_step&gt;
</code></pre>

<hr />
<p>Add a host entry in your <strong>host machine</strong></p>
<p>(use sudo/administrator)</p>
<pre><code>192.168.56.101  elkhost.defcon
</code></pre>

<pre><code>notepad %windir%\System32\drivers\etc\hosts
</code></pre>

<pre><code>echo &quot;192.168.56.101  elkhost.defcon&quot; | sudo tee --append /etc/hosts
</code></pre>

<hr />
<h3 id="installing-java"><a name="user-content-installing-java" href="#installing-java" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing Java</h3>
<ul>
<li>Elasticsearch &amp; Logstash requires Java to run</li>
<li>The virtual machine already has JAVA installed</li>
</ul>
<hr />
<h3 id="installing-java_1"><a name="user-content-installing-java_1" href="#installing-java_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing Java</h3>
<ul>
<li>The commands below will add the repository and install Java (in case you want to try this out)</li>
</ul>
<pre><code>sudo add-apt-repository -y ppa:webupd8team/java
sudo apt-get update -y
sudo apt-get -y install oracle-java8-installer
</code></pre>

<ul>
<li>Check the JAVA installation version by running the command below</li>
</ul>
<pre><code>java -version
</code></pre>

<hr />
<h2 id="setting-up-elasticsearch"><a name="user-content-setting-up-elasticsearch" href="#setting-up-elasticsearch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Setting up Elasticsearch</h2>
<p>(let&rsquo;s get our hands dirty!)</p>
<hr />
<div align="left">**PS:** We have provided installer files in the VM `/home/ninja/pkgs` directory
<br />
<br />
**PPS:** We weren't sure of the Internet connectivity here when creating the VM
</div>

<hr />
<h3 id="installing-elasticsearch"><a name="user-content-installing-elasticsearch" href="#installing-elasticsearch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing Elasticsearch</h3>
<p>(hands on)</p>
<ul>
<li>Install Elasticsearch by running the command below:</li>
</ul>
<pre><code>sudo dpkg -i /home/ninja/pkgs/elasticsearch.deb
</code></pre>

<p>Note: since the deb file has already been downloaded. The usual route would be to add the Elasticsearch gpg key, add the Elasticsearch repo to the sources and then the standard apt-update and apt-get install.</p>
<hr />
<ul>
<li>Start Elasticsearch service by running:</li>
</ul>
<pre><code>sudo service elasticsearch start
</code></pre>

<hr />
<ul>
<li>Check whether Elasticsearch is running or not:</li>
</ul>
<pre><code>curl -XGET 'http://localhost:9200'
</code></pre>

<hr />
<h3 id="elasticsearch-configuration"><a name="user-content-elasticsearch-configuration" href="#elasticsearch-configuration" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Elasticsearch configuration</h3>
<p>(hands on)</p>
<hr />
<ul>
<li>Some basic configurations to start with:</li>
</ul>
<pre><code>sudo vi /etc/elasticsearch/elasticsearch.yml
</code></pre>

<hr />
<p>Uncomment the following lines, make the changes as shown below and save the file:</p>
<hr />
<div align="left">Cluster name should be unique:</div>

<pre><code>cluster.name: elk-defcon
</code></pre>

<div align="left">Node name is to identify the node in a cluster:</div>

<pre><code>node.name: node-1
</code></pre>

<div align="left">To avoid memory swapping for Elasticsearch:</div>

<pre><code>bootstrap.mlockall: true
</code></pre>

<div align="left">Access:</div>

<pre><code>network.host: 0.0.0.0
</code></pre>

<p>Note: Cluster name used to connect across nodes.<br /><br />
Node names are mostly hostnames.<br /><br />
To avoid swapping for elasticsearch.<br /><br />
Protect access.<br /></p>
<hr />
<div align="left">Restart the Elasticsearch service:</div>

<pre><code>sudo service elasticsearch restart
</code></pre>

<hr />
<div align="left">Check the Elasticsearch cluster status</div>

<p><pre><code>curl -XGET 'http://localhost:9200/_cluster/health?pretty'

curl -XGET 'http://localhost:9200/_cluster/state?pretty'
</code></pre><br />
<br /><br />
<div style="font-size:15px" align="left"><br />
- <font color="green"><code>green</code></font> - All primary and replica shards are active.<br />
- <font color="yellow"><code>yellow</code></font> - All primary shards are active, but not all replica shards are active.<br />
- <font color="red"><code>red</code></font> - Not all primary shards are active.<br />
<div></p>
<hr />
<h3 id="setting-up-another-node"><a name="user-content-setting-up-another-node" href="#setting-up-another-node" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Setting up another node</h3>
<p>(hands on)</p>
<h4 id="ps-open-another-ssh-session"><a name="user-content-ps-open-another-ssh-session" href="#ps-open-another-ssh-session" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>PS: Open another SSH session</h4>
<hr />
<div align="left">To add another node, we extract the files from the elasticsearch tar zip:</div>

<pre><code>tar -xvf /home/ninja/pkgs/elasticsearch-2.3.4.tar.gz -C /home/ninja/pkgs/

cd /home/ninja/pkgs/elasticsearch-2.3.4
</code></pre>

<div align="left">And edit the config as we did for the previous node:</div>

<pre><code>vi config/elasticsearch.yml
</code></pre>

<hr />
<div align="left">Add a node name, while keeping the cluster name constant across both the nodes:</div>

<pre><code>cluster.name: elk-defcon
node.name: node-2
bootstrap.mlockall: true
network.host: 0.0.0.0
</code></pre>

<hr />
<div align="left">Start the second node by running the following command:</div>

<pre><code>./bin/elasticsearch
</code></pre>

<p>Note: We use the same VM to install another node on the side</p>
<hr />
<div align="left">Recheck the Elasticsearch cluster status now:</div>

<pre><code>curl -XGET 'http://localhost:9200/_cluster/health?pretty'

curl -XGET 'http://localhost:9200/_cluster/state?pretty'
</code></pre>

<hr />
<h2 id="so-what-happens-in-a-multi-node-cluster"><a name="user-content-so-what-happens-in-a-multi-node-cluster" href="#so-what-happens-in-a-multi-node-cluster" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>So What happens in a multi node cluster?</h2>
<hr />
<h3 id="clustering"><a name="user-content-clustering" href="#clustering" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Clustering</h3>
<blockquote>
<p>Elasticsearch is built to be always available, and to scale. Scale can come from buying bigger servers (vertical scale, or scaling up) or from buying more servers (horizontal scale, or scaling out).</p>
</blockquote>
<p>Note: We need to start by understanding the word &lsquo;Clustering&rsquo; in context with Elasticsearch</p>
<hr />
<h3 id="an-empty-cluster"><a name="user-content-an-empty-cluster" href="#an-empty-cluster" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>An Empty Cluster</h3>
<p>Our cluster with a single node, with no data and no indices:</p>
<p><img alt="A cluster with one empty node" src="./images/es-c-1.png" /></p>
<ul>
<li>A node is a running instance of Elasticsearch</li>
<li>A Cluster consists of one or more nodes with the same cluster.name</li>
</ul>
<p>Note:By default Elasticsearch will have 5 primary shards and 1 replica shard with cluster name <code>elasticsearch</code> and node name as a random Marvel character.</p>
<hr />
<h3 id="adding-index"><a name="user-content-adding-index" href="#adding-index" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Adding index</h3>
<ul>
<li>In an empty one-node cluster, we will assign three primary shards and one replica</li>
<li>There is one replica for all the primary shards</li>
</ul>
<p><img alt="A single-node cluster with an index" src="./images/es-c-2.png" /></p>
<p>Note: Because there is no separate node, the replica shard becomes unassigned. Which is why it is not denoted in this image.</p>
<hr />
<h3 id="add-failover"><a name="user-content-add-failover" href="#add-failover" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Add Failover</h3>
<ul>
<li>Running a single node means that you have a single point of failure - there is no redundancy</li>
<li>We can simply start another node to prevent data loss</li>
</ul>
<p><img alt="A two-node cluster—all primary and replica shards are allocated" src="./images/es-c-3.png" /></p>
<hr />
<h3 id="scale-horizontally"><a name="user-content-scale-horizontally" href="#scale-horizontally" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Scale Horizontally</h3>
<ul>
<li>One shard each from Node 1 and Node 2 have moved to the new Node 3</li>
</ul>
<p><img alt="A three-node cluster—shards have been reallocated to spread the load" src="./images/es-c-4.png" /><br />
Note: This means that the hardware resources (CPU, RAM, I/O) of each node are being shared among fewer shards, allowing each shard to perform better</p>
<hr />
<h3 id="scale-more"><a name="user-content-scale-more" href="#scale-more" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Scale more</h3>
<p>Three primaries and six replicas. This means that we can scale out to a total of nine nodes, again with one shard per node</p>
<p><img alt="Increasing the number_of_replicas to 2" src="./images/es-c-5.png" /></p>
<p>Note: This would allow us to triple search performance compared to our original three-node cluster</p>
<hr />
<h3 id="failover-test"><a name="user-content-failover-test" href="#failover-test" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Failover Test</h3>
<ul>
<li>A cluster must have a master node in order to function correctly</li>
<li>When a master node dies, the nodes elect a new master</li>
</ul>
<p><img alt="Cluster after killing one node" src="./images/es-c-6.png" /></p>
<hr />
<h3 id="installing-elasticsearch-plugins"><a name="user-content-installing-elasticsearch-plugins" href="#installing-elasticsearch-plugins" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing Elasticsearch plugins</h3>
<p>(hands on)<br />
<br /><br />
<br /><br />
We downloaded the plugins as well: <code>/home/ninja/plugins/</code></p>
<hr />
<div align="left">To check the list of installed plugins</div>

<pre><code>sudo /usr/share/elasticsearch/bin/plugin list
</code></pre>

<div align="left">To install the head plugin from a local file:</div>

<pre><code>sudo /usr/share/elasticsearch/bin/plugin install file:/home/ninja/plugins/head.zip
</code></pre>

<div align="left">To install the hq plugin from a local file:</div>

<pre><code>sudo /usr/share/elasticsearch/bin/plugin install file:/home/ninja/plugins/hq.zip
</code></pre>

<hr />
<div align="left">To download and install directly from the Internet repo:</div>

<pre><code>sudo /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head
</code></pre>

<hr />
<h3 id="elasticsearch-plugins-overview"><a name="user-content-elasticsearch-plugins-overview" href="#elasticsearch-plugins-overview" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Elasticsearch plugins overview</h3>
<hr />
<p><img alt="" src="./images/elasticsearch-head-plugin.png" /></p>
<hr />
<p><img alt="" src="./images/elasticsearch-hq-plugin.png" /></p>
<p>Note: We can talk this out with examples.</p>
<hr />
<h3 id="restful-apis-over-http-curl"><a name="user-content-restful-apis-over-http-curl" href="#restful-apis-over-http-curl" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Restful APIs over <code>HTTP</code> (CURL)</h3>
<p><pre><code>curl -X&lt;VERB&gt; '&lt;SCHEMA&gt;://&lt;HOST&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;' -d '&lt;BODY&gt;'
</code></pre><br />
<br /><br />
Note:<br />
<div style="font-size:15px" align="left"><br />
<code>VERB</code> - The appropriate HTTP method or verb: GET, POST, PUT, HEAD, or DELETE.<br /><br />
<code>SCHEMA</code> - Either http or https (if you have an https proxy in front of Elasticsearch.)<br /><br />
<code>HOST</code> - The hostname of any node in your Elasticsearch cluster, or localhost for a node on your local machine.<br /><br />
<code>PORT</code> - The port running the Elasticsearch HTTP service, which defaults to 9200.<br /><br />
<code>QUERY_STRING</code> - Any optional query-string parameters (for example ?pretty will pretty-print the JSON response to make it easier to read.)<br /><br />
<code>BODY</code> - A JSON encoded request body (if the request needs one.)<br /><br />
</font><br />
</div></p>
<hr />
<h3 id="what-is-crud"><a name="user-content-what-is-crud" href="#what-is-crud" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>What is CRUD?</h3>
<p>C - Create<br />
R - Retrieve<br />
U - Update<br />
D - Delete</p>
<hr />
<h3 id="crud-operations-over-elasticsearch"><a name="user-content-crud-operations-over-elasticsearch" href="#crud-operations-over-elasticsearch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>CRUD operations over Elasticsearch</h3>
<p>(hands on)</p>
<hr />
<div align="left">Simple Index Creation with XPUT:</div>

<pre><code>curl -XPUT 'http://localhost:9200/defcon/'
</code></pre>

<div align="left">Add data to your created index:</div>

<pre><code>curl -XPUT 'http://localhost:9200/defcon/workshop/1' -d '{&quot;user&quot;:&quot;ninja&quot;}'
</code></pre>

<div align="left">To check the Index status:</div>

<pre><code>curl -XGET 'http://localhost:9200/defcon/?pretty'
</code></pre>

<hr />
<div align="left">Automatic doc creation in an index with XPOST:</div>

<pre><code>curl -XPOST 'http://localhost:9200/defcon/workshop/' -d '{&quot;user&quot;:&quot;ninja&quot;}'
</code></pre>

<div align="left">Creating a user profile doc:</div>

<pre><code>curl -XPUT 'http://localhost:9200/defcon/workshop/9' -d '{&quot;user&quot;:&quot;admin&quot;, &quot;role&quot;:&quot;tester&quot;, &quot;job&quot;:&quot;engineer&quot;}'
</code></pre>

<div align="left">Update the document:</div>

<pre><code>curl -XPOST 'http://localhost:9200/defcon/workshop/9' -d '{&quot;user&quot;:&quot;administrator&quot;, &quot;role&quot;:&quot;tester&quot;, &quot;job&quot;:&quot;engineer&quot;}'
</code></pre>

<hr />
<div align="left">Searching a doc in an index. Create 2 docs:</div>

<pre><code>curl -XPOST 'http://localhost:9200/defcon/workshop/' -d '{&quot;user&quot;:&quot;abcd&quot;, &quot;role&quot;:&quot;tester&quot;, &quot;job&quot;:&quot;engineer&quot;}'
</code></pre>

<pre><code>curl -XPOST 'http://localhost:9200/defcon/workshop/' -d '{&quot;user&quot;:&quot;abcd&quot;, &quot;role&quot;:&quot;admin&quot;, &quot;job&quot;:&quot;engineer&quot;}'
</code></pre>

<div align="left">Then search:</div>

<pre><code>curl -XGET 'http://localhost:9200/defcon/_search?q=user:abcd&amp;pretty'
</code></pre>

<div align="left">Deleting a doc in an index:</div>

<pre><code>curl -XDELETE 'http://localhost:9200/defcon/workshop/1'
</code></pre>

<hr />
<h2 id="setting-up-logstash"><a name="user-content-setting-up-logstash" href="#setting-up-logstash" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Setting up Logstash</h2>
<hr />
<p><img alt="Logstash Overview" src="./images/logstash.png" /></p>
<hr />
<h3 id="logstash-components"><a name="user-content-logstash-components" href="#logstash-components" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Logstash components</h3>
<p>Logstash consists of 3 main components</p>
<ul>
<li>Input: Passing logs to process them into machine understandable format</li>
<li>Filters: Set of conditionals to perform specific action on a event </li>
<li>Output: Decision maker for processed events/logs</li>
</ul>
<hr />
<h3 id="basic-logstash-configuration"><a name="user-content-basic-logstash-configuration" href="#basic-logstash-configuration" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Basic Logstash configuration</h3>
<pre><code>input {
    stdin {}
    file {}
    ...
}

filter {
    grok {}
    date {}
    geoip {}
    ...
}

output {
   elasticsearch {}
   email {}
   ...
}
</code></pre>

<hr />
<h4 id="input"><a name="user-content-input" href="#input" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Input</h4>
<blockquote>
<p>An input plugin enables a specific source of events to be read by Logstash.</p>
</blockquote>
<ul>
<li>File</li>
<li>Lumberjack</li>
<li>S3</li>
<li>Beats</li>
<li>Stdin</li>
<li>Many more.<br />
<a href="https://www.elastic.co/guide/en/logstash/current/input-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/input-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/input-plugins.html">https://www.elastic.co/guide/en/logstash/current/input-plugins.html</a></a></a></li>
</ul>
<hr />
<h4 id="filter"><a name="user-content-filter" href="#filter" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Filter</h4>
<blockquote>
<p>A filter plugin performs intermediary processing on an event. Filters are often applied conditionally depending on the characteristics of the event.</p>
</blockquote>
<ul>
<li>CSV</li>
<li>GeoIP</li>
<li>Mutate</li>
<li>Grok</li>
<li>Many More.<br />
<a href="https://www.elastic.co/guide/en/logstash/current/filter-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/filter-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/filter-plugins.html">https://www.elastic.co/guide/en/logstash/current/filter-plugins.html</a></a></a></li>
</ul>
<hr />
<h4 id="output"><a name="user-content-output" href="#output" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Output</h4>
<blockquote>
<p>An output plugin sends event data to a particular destination. Outputs are the final stage in the event pipeline.</p>
</blockquote>
<ul>
<li>Elasticsearch</li>
<li>Email</li>
<li>Stdout</li>
<li>S3, file</li>
<li>HTTP</li>
<li>Many More. <br />
<a href="https://www.elastic.co/guide/en/logstash/current/output-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/output-plugins.html"><a href="https://www.elastic.co/guide/en/logstash/current/output-plugins.html">https://www.elastic.co/guide/en/logstash/current/output-plugins.html</a></a></a></li>
</ul>
<hr />
<h3 id="installing-logstash"><a name="user-content-installing-logstash" href="#installing-logstash" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing logstash</h3>
<p>(hands on)</p>
<hr />
<p>To install logstash package run the command below</p>
<pre><code>sudo dpkg -i /home/ninja/pkgs/logstash.deb
</code></pre>

<hr />
<h3 id="basic-logstash-pipeline"><a name="user-content-basic-logstash-pipeline" href="#basic-logstash-pipeline" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Basic logstash pipeline</h3>
<div align="left">A quick test to check your logstash installation:</div>

<pre><code>sudo /opt/logstash/bin/logstash -e 'input { stdin {} } output { stdout {} }'
</code></pre>

<hr />
<h3 id="a-quick-primer-on-grok-filters"><a name="user-content-a-quick-primer-on-grok-filters" href="#a-quick-primer-on-grok-filters" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>A quick primer on Grok filters</h3>
<hr />
<ul>
<li>The syntax for a grok pattern is <code>%{SYNTAX:SEMANTIC}</code></li>
<li><code>SYNTAX</code> is the name of the pattern that will match your text.<ul>
<li>For example: <code>1337</code> will be matched by the <code>NUMBER</code> pattern, <code>192.168.123.12</code> will be matched by the <code>IP</code> pattern.</li>
</ul>
</li>
<li>SEMANTIC is the identifier you give to the piece of text being matched.<br />
E.g. <code>1337</code> could be the count and <code>192.168.123.12</code> could be a <code>client</code> making a request</li>
</ul>
<pre><code>%{NUMBER:count} 
%{IP:client}
</code></pre>

<p>Note: Grok is based on pre created regex patterns</p>
<hr />
<h3 id="example-grok"><a name="user-content-example-grok" href="#example-grok" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Example grok</h3>
<div align="left">For the following log event:</div>

<pre><code>55.3.244.1 GET /index.html 15824 0.043
</code></pre>

<div align="left">This would be the matching grok:</div>

<pre><code>%{IP:client} %{WORD:method} %{URIPATHPARAM:request} %{NUMBER:bytes} %{NUMBER:duration}
</code></pre>

<hr />
<h4 id="consider-the-following-apache-log-event"><a name="user-content-consider-the-following-apache-log-event" href="#consider-the-following-apache-log-event" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Consider the following Apache Log Event</h4>
<div align="left">123.249.19.22 - - [01/Feb/2015:14:12:13 +0000] "GET /manager/html HTTP/1.1" 404 448 "-" "Mozilla/3.0 (compatible; Indy Library)"</div>

<hr />
<p>Using a regular expression!!</p>
<p><img alt="Apache RegEx" src="./images/apacheregex.png" /></p>
<hr />
<p>Using Grok filter patterns :)</p>
<pre><code>%{IPV4} %{USER:ident} %{USER:auth} \[%{HTTPDATE:timestamp}\] &quot;(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?)&quot; %{NUMBER:response} (?:%{NUMBER:bytes}|-)
</code></pre>

<hr />
<p>Things can get even more simpler using an <em>inbuilt</em> grok :) :) </p>
<pre><code>%{COMBINEDAPACHELOG}
</code></pre>

<hr />
<h3 id="available-logstash-grok-patterns"><a name="user-content-available-logstash-grok-patterns" href="#available-logstash-grok-patterns" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Available Logstash Grok Patterns</h3>
<ul>
<li><a href="https://grokdebug.herokuapp.com/patterns"><a href="https://grokdebug.herokuapp.com/patterns"><a href="https://grokdebug.herokuapp.com/patterns">https://grokdebug.herokuapp.com/patterns</a></a></a></li>
<li><a href="http://grokconstructor.appspot.com/"><a href="http://grokconstructor.appspot.com/"><a href="http://grokconstructor.appspot.com/">http://grokconstructor.appspot.com/</a></a></a></li>
<li><a href="https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/grok-patterns"><a href="https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/grok-patterns"><a href="https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/grok-patterns">https://github.com/logstash-plugins/logstash-patterns-core/blob/master/patterns/grok-patterns</a></a></a></li>
<li><a href="https://github.com/clay584/logstash_configs"><a href="https://github.com/clay584/logstash_configs"><a href="https://github.com/clay584/logstash_configs">https://github.com/clay584/logstash_configs</a></a></a></li>
</ul>
<hr />
<h3 id="apache-log-sample-with-elasticsearch"><a name="user-content-apache-log-sample-with-elasticsearch" href="#apache-log-sample-with-elasticsearch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Apache log sample with elasticsearch</h3>
<p>(hands on)</p>
<hr />
<p>Let&rsquo;s parse some Apache logs in elasticsearch using logstash</p>
<hr />
<p>Create a logstash config file using the following command:</p>
<pre><code>sudo vi /etc/logstash/conf.d/apache.conf
</code></pre>

<hr />
<pre><code>input {
    file {
        path =&gt; &quot;/home/ninja/log-samples/access.log&quot;
        start_position =&gt; beginning
        ignore_older =&gt; 0
    }
}
filter {
    grok {
        match =&gt; { &quot;message&quot; =&gt; &quot;%{COMBINEDAPACHELOG}&quot;}
    }
    geoip {
        source =&gt; &quot;clientip&quot;
    }
}
output {
    elasticsearch {
            hosts =&gt; [&quot;localhost:9200&quot;]
            index =&gt; &quot;apache-logs&quot;
    }
    #stdout {}
}
</code></pre>

<hr />
<p>Then provide the config to logstash to start the pipeline</p>
<pre><code>sudo /opt/logstash/bin/logstash -f /etc/logstash/conf.d/apache.conf
</code></pre>

<hr />
<p>Then check the elasticsearch head plugin</p>
<pre><code>http://elkhost.defcon:9200/_plugin/head
</code></pre>

<hr />
<h2 id="setting-up-kibana"><a name="user-content-setting-up-kibana" href="#setting-up-kibana" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Setting up Kibana</h2>
<hr />
<blockquote>
<p>Kibana is an open source analytics and visualization platform designed to work with Elasticsearch. You use Kibana to search, view, and interact with data stored in Elasticsearch indices</p>
</blockquote>
<hr />
<h3 id="installing-kibana"><a name="user-content-installing-kibana" href="#installing-kibana" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Installing Kibana</h3>
<p>(hands on)</p>
<hr />
<div align="left">To install the Kibana package, run the command below:</div>

<pre><code>sudo dpkg -i /home/ninja/pkgs/kibana.deb
</code></pre>

<hr />
<h3 id="basic-kibana-configuration"><a name="user-content-basic-kibana-configuration" href="#basic-kibana-configuration" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Basic Kibana configuration</h3>
<p>Just for reference, Here is the kibana config file:</p>
<pre><code>sudo vi /opt/kibana/config/kibana.yml
</code></pre>

<p>Note: Kibana works out of the box support with Elasticsearch</p>
<hr />
<div align="left">Uncomment and change the server address to access the kibana dashboard</div>

<pre><code>server.host: &quot;0.0.0.0&quot;
</code></pre>

<div align="left">Then start the kibana service by running</div>

<pre><code>sudo service kibana start
</code></pre>

<hr />
<p>Kibana Dashboard<br />
<pre><code>http://elkhost.defcon:5601/
</code></pre></p>
<hr />
<h3 id="understanding-the-kibana-ui"><a name="user-content-understanding-the-kibana-ui" href="#understanding-the-kibana-ui" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Understanding the Kibana UI</h3>
<p><strong>Index Selection</strong></p>
<p><img alt="" src="./images/k-1.png" /></p>
<hr />
<p><strong>Adding multiple indices</strong></p>
<p><img alt="" src="./images/k-2.png" /></p>
<hr />
<p><strong>Discovery</strong></p>
<p><img alt="" src="./images/k-3.png" /></p>
<hr />
<p><strong>Mapped log in JSON format</strong></p>
<p><img alt="" src="./images/k-4.png" /></p>
<hr />
<p><strong>Visualize</strong></p>
<p><img alt="" src="./images/k-5.png" /></p>
<hr />
<p><strong>Selecting the search source</strong></p>
<p><img alt="" src="./images/k-6.png" /></p>
<hr />
<p><strong>Creating a pie chart</strong></p>
<p><img alt="" src="./images/k-7.png" /></p>
<hr />
<p><strong>Discover</strong></p>
<p><img alt="" src="./images/k-9.png" /></p>
<hr />
<p><strong>Status</strong></p>
<p><img alt="" src="./images/k-10.png" /></p>
<hr />
<p><strong>Import/Export</strong></p>
<p><img alt="" src="./images/k-11.png" /></p>
<hr />
<p>Throughout our exercises, did you notice anything missing?</p>
<hr />
<h3 id="securing-elasticsearch-kibana"><a name="user-content-securing-elasticsearch-kibana" href="#securing-elasticsearch-kibana" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Securing Elasticsearch &amp; Kibana</h3>
<ul>
<li>By default elasticsearch and kibana doesn&rsquo;t have security</li>
<li>We are setting up basic authentication using <code>htpasswd</code> and <code>nginx</code> reverse proxy</li>
<li>The commercial product called <code>shield</code> is available from company. </li>
<li><code>Search Guard</code> is an alternative open source project for <code>shield</code>.</li>
</ul>
<hr />
<h3 id="basic-authentication-setup-for-elasticsearch-kibana"><a name="user-content-basic-authentication-setup-for-elasticsearch-kibana" href="#basic-authentication-setup-for-elasticsearch-kibana" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Basic Authentication setup for Elasticsearch &amp; Kibana</h3>
<p>(hands on)</p>
<hr />
<p>Installing <code>nginx</code> and <code>apache2-utils</code>.</p>
<p>(It&rsquo;s already installed in the virtual machine)</p>
<pre><code>sudo apt-get install nginx apache2-utils -y
</code></pre>

<hr />
<p>To create basic authentication user and password.</p>
<pre><code>sudo htpasswd -c /etc/nginx/htpasswd.users elkadmin
</code></pre>

<pre><code>Password : D3fc0nN!nj@
Confirm Password : D3fc0nN!nj@
</code></pre>

<p>Note:<code>elkadmin</code> is the username and password is <code>D3fc0nN!nj@</code></p>
<hr />
<div align="left">Then edit the configuration file of nginx using:</div>

<pre><code>sudo vi /etc/nginx/sites-available/default
</code></pre>

<hr />
<pre><code>server {
    listen 80; #for Kibana

    server_name localhost;

    auth_basic &quot;Restricted Access&quot;;
    auth_basic_user_file /etc/nginx/htpasswd.users;

    location / {
        proxy_pass http://localhost:5601;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;        
    }
}

server {
    listen 8080; #for Elasticsearch

    server_name localhost;

    auth_basic &quot;Restricted Access&quot;;
    auth_basic_user_file /etc/nginx/htpasswd.users;

    location / {
        proxy_pass http://localhost:9200;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
</code></pre>

<hr />
<div align="left">Restart the nginx service:</div>

<pre><code>sudo service nginx restart
</code></pre>

<hr />
<div align="left">Open the `elasticsearch.yml` and add a host restriction:</div>

<pre><code>sudo vi /etc/elasticsearch/elasticsearch.yml
</code></pre>

<div align="left">Restrict ES access to localhost:</div>

<pre><code>network.host: localhost
</code></pre>

<div align="left">Then restart the service:</div>

<pre><code>sudo service elasticsearch restart
</code></pre>

<hr />
<div align="left">Add the authentication credentials in Kibana:</div>

<pre><code>sudo vi /opt/kibana/config/kibana.yml
</code></pre>

<div align="left">Modify the following entry:</div>

<pre><code>server.host: &quot;localhost&quot;
</code></pre>

<div align="left">Then restart the kibana service:</div>

<pre><code>sudo service kibana restart
</code></pre>

<hr />
<div align="left">Test the changes in Elasticsearch and Kibana by navigating to:</div>

<pre><code>http://elkhost.defcon:80
</code></pre>

<pre><code>http://elkhost.defcon:8080
</code></pre>

<hr />
<h3 id="backing-up-elasticsearch-using-curator"><a href="03-backup-es.html">Backing up Elasticsearch using Curator</a></h3></article></body></html>